KUBERNETES :

```

  
kubernetes cluster: 
master node : management pods
worker nodes : my application pods

kubectl run : master



kube cluster from scratch
kubeadm : helps to create a kube cluster : full control on my master as well worker
aws (eks)/gcp (gks)/azure (aks) : managed clusters : without control of master


3 servers :

1 master : t2.medium : 
2 worker nodes : t2.micro : free tier 



Software Image (AMI)
Ubuntu Server 20.04 LTS (HVM)

Virtual server type (instance type)
t2.medium (only for master node)
t2.micro (only for worker nodes)

Firewall (security group)
raman-synechron-sg (all ports open)

Storage (volumes)
1 volume(s) - 20 GiB




#!/bin/bash
sudo echo -e "Tech@2020\nTech@2020" | passwd root;
sudo cp -p /etc/ssh/sshd_config /etc/ssh/sshd_config_backup;
sudo sed -i 's/^PasswordAuthentication.*/PasswordAuthentication yes/' /etc/ssh/sshd_config;
sudo sed -i 's/^PermitRootLogin*/PermitRootLogin yes/' /etc/ssh/sshd_config;
sudo echo "PermitRootLogin yes" >> /etc/ssh/sshd_config;
sudo systemctl restart sshd;
sudo systemctl stop firewalld;
sudo systemctl disable firewalld;







---------
after creation : login :

ssh root@publicip



hostnamectl set-hostname master
bash


```

```
==============================================


10.0.0.0/24

32-24 : 8

2 raise to power 8




script :

on master : full script
make a note of the join command..

on worker nodes : not full script

till .....iptables=1



---

run the join command on both wrker nodes 

----
clear
    2  ls
    3  vi script
    4  l
    5  sh script
    6  kubectl
    7  kubectl get nodes
    8  kubectl get nodes -o wide

```

```

kubectl get nodes
    8  kubectl get nodes -o wide
    9  history
   10  clear
   11  alias k=kubectl
   12  clear
   13  k get nodes
   14  k get pod
   15  k get pods
   16  k get pods -A
   17  k get pods
   18  k get pods -A -o wide
   19  clear
   20  k get pods -A -o wide
   21  docker ps
   22  clea
   23  clear
   24  k get pods -A -o wide
   25  clea
   26  clear
   27  k get pods -A
   28  k get pods
   29  clear
   30  k get pods -A | grep -i master
   31  k get pods -A | grep -i worker1
   32  k get pods -A
   33  clear
   34  k get pods -A -o wide | grep -i master
   35  k get pods -A -o wide | grep -i worker2
   36  k get pods -A -o wide | grep -i worker1
   37  clear
   38  k run ramanapp --image httpd
   39  k get pods
   40  k get pods -o wide
   41  clear
   42  k get pods -o wide
   43  curl 192.168.189.65
   44  k get pods
   45  k get pods -A
   46  clear
   47  k get pods
   48  k delete pod ramanapp
   49  k get pods
   50  k run ramanapp --image nginx
   51  k get pods
   52  k get pods -o wide

```

```


commandline way 
declarative 

pods 



 clear
   55  k get api-resource
   56  clear
   57  k get api-resources
   58  ls
   59  vi pod.yml
   60  k api-resources
   61  clear
   62  k api-resources
   63  cat pod.yml
   64  clear
   65  ls
   66  cat pod.yml
   67  k get pods
   68  vi pod.yml
   69  ls
   70  k create -f pod.yml
   71  ls
   72  k get pods
   73  k get pods -o wide
   74  k delete pods --all
   75  ls
   76  k get ppods
   77  k get ods
   78  k get pods
   79  ls
   80  k create -f pod.yml
   81  k get pods
   82  clear
   83  ls
   84  k get pods
   85  k delete -f pod.yml
   86  vi pod.yml
   87  k create -f pod.yml








root@master:~# cat pod.yml
apiVersion: v1
kind: Pod
metadata:
  name: raman-app2
spec:
  containers:
  - name: container1
    image: nginx:1.14.2
    ports:
    - containerPort: 80
  - name: container2
    image: redis
    ports:
    - containerPort: 6379
---
apiVersion: v1
kind: Pod
metadata:
  name: raman-app3
spec:
  containers:
  - name: container1
    image: httpd
    ports:
    - containerPort: 80











   88  k get pods
   89  k get pods -o wide
   90  k exec -it raman-app2 -c container1 -- /bin/bash
   91  k exec -it raman-app2 -c container1 -- ls
   92  k exec -it raman-app2 -c container1 -- mkdir raman
   93  k exec -it raman-app2 -c container1 -- ls
   94  k exec -it raman-app2 -c container1 -- /bin/bash
   95  ls
   96  k get pods
   97  k exec -it raman-app2 -c container2 -- /bin/bash


---------------------------------

controller manager : mngemnt pod which state part :

deployment  : object
   replicaset : object




10 pods -- httpd


ramandeploy : deployment
        ramandeploy-59854bf468 : rs
                   ramandeploy-59854bf468-45ljd   1/1     Running   0          95s






k exec -it raman-app2 -c container2 -- /bin/bash
   98  clear
   99  history
  100  k get pods
  101  vi pod.yml
  102  k delete pods --all
  103  k create -f pod.yml
  104  k get pods
  105  k describe pod raman-app3
  106  clear
  107  k get pods
  108  clear
  109  k get pods
  110  k delete pods --all
  111  clear
  112  k get pods
  113  k create deploy ramandeploy --image httpd --replicas 10
  114  k get all
  115  clear
  116  k get deploy
  117  k get rs
  118  k get pods
  119  k delete pod ramandeploy-59854bf468-s7kts
  120  k get pods
  121  k scale deploy ramandeploy --image 5
  122  k scale deploy ramandeploy --replicas 5
  123  k get pods
  124  k scale deploy ramandeploy --replicas 15
  125  k get pods
  126  k get pods -o wide

==============================================================
```


```



 k run httpod --image httpd
  139  k get pods
  140  k get pods -o wide
  141  curl 192.168.189.78
  142  k expose pod httpod --name extpod --target-port 80 --port 80
  143  k get svc
  144  k describe svc extpod
  145  k get pods -o wide
  146  clear
  147  k get pods
  148  k get svc
  149  k expose pod httpod --name extpodd --type NodePort --target-port 80 --port 80
  150  k get svc
  151  k delete svc extpod
  152  k get svc
  153  clear
  154  k describe svc extpodd


 k describe svc extpodd
  155  clea
  156  clear
  157  history
  158  k delete pods --all
  159  k delete svc --all
  160  clear
  161  k get svc
  162  k get pods
  163  k create deploy ramannginx --image nginx --replicas 5
  164  k get pods
  165  k expose deploy ramannginx --name extnginx --type NodePort --target-port 80 --port 80
  166  k get svc
  167  k describe svc extnginx
  168  k get pods -o wide
  169  clear
  170  k create deploy ramanhttp --image httpd --replicas 5
  171  k expose deploy ramannhttp --name exthttp --type NodePort --target-port 80 --port 80
  172  k expose deploy ramanhttp --name exthttp --type NodePort --target-port 80 --port 80
  173  k get svc
  174  k describe exthttp
  175  k describe svc exthttp
  176  clear


---------------
```
